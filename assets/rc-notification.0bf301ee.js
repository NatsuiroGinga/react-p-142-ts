import{g as K,h as S,i as R,j,d as D,c as U,f as I,a as N,b as O}from "./@babel.3781e41b.js";import{r as M}from "./react.aaec2051.js";import{r as L,v as W}from "./rc-util.5fc3e0fc.js";import{c as T}from "./classnames.4fb4381a.js";import{a as F}from "./rc-motion.a15f39b3.js";import{R as V}from "./react-dom.18596681.js";import{b as q,j as y,F as z}from "./@ant-design.023abccc.js";var _=function(k){K(f,k);var C=S(f);function f(){var e;R(this,f);for(var n=arguments.length,r=new Array(n),t=0; t<n; t++)r[t]=arguments[t];return e=C.call.apply(C,[this].concat(r)),e.closeTimer=null,e.close=function(a){a&&a.stopPropagation(),e.clearCloseTimer();var u=e.props,p=u.onClose,c=u.noticeKey;p&&p(c)},e.startCloseTimer=function(){e.props.duration&&(e.closeTimer=window.setTimeout(function(){e.close()},e.props.duration*1e3))},e.clearCloseTimer=function(){e.closeTimer&&(clearTimeout(e.closeTimer),e.closeTimer=null)},e}return j(f,[{key:"componentDidMount",value:function(){this.startCloseTimer()}},{key:"componentDidUpdate",value:function(n){(this.props.duration!==n.duration||this.props.updateMark!==n.updateMark||this.props.visible!==n.visible&&this.props.visible)&&this.restartCloseTimer()}},{key:"componentWillUnmount",value:function(){this.clearCloseTimer()}},{key:"restartCloseTimer",value:function(){this.clearCloseTimer(),this.startCloseTimer()}},{key:"render",value:function(){var n=this,r=this.props,t=r.prefixCls,a=r.className,u=r.closable,p=r.closeIcon,c=r.style,l=r.onClick,s=r.children,i=r.holder,o="".concat(t,"-notice"),m=Object.keys(this.props).reduce(function(h, d){return(d.substr(0,5)==="data-"||d.substr(0,5)==="aria-"||d==="role")&&(h[d]=n.props[d]),h},{}),v=q("div",{className:T(o,a,D({},"".concat(o,"-closable"),u)),style:c,onMouseEnter:this.clearCloseTimer,onMouseLeave:this.startCloseTimer,onClick:l,...m,children:[y("div",{className:"".concat(o,"-content"),children:s}),u?y("a",{tabIndex:0,onClick:this.close,className:"".concat(o,"-close"),children:p||y("span",{className:"".concat(o,"-close-x")})}):null]});return i?V.createPortal(v,i):v}}]),f}(M.exports.Component);_.defaultProps={onClose:function(){},duration:1.5};function B(k){var C=M.exports.useRef({}),f=M.exports.useState([]),e=U(f,2),n=e[0],r=e[1];function t(a){var u=!0;k.add(a,function(p, c){var l=c.key;if(p&&(!C.current[l]||u)){var s=y(_,{...c,holder:p});C.current[l]=s,r(function(i){var o=i.findIndex(function(v){return v.key===c.key});if(o===-1)return[].concat(I(i),[s]);var m=I(i);return m[o]=s,m})}u=!1})}return[t,y(z,{children:n})]}var E=["getContainer"],$=0,G=Date.now();function w(){var k=$;return $+=1,"rcNotification_".concat(G,"_").concat(k)}var g=function(k){K(f,k);var C=S(f);function f(){var e;R(this,f);for(var n=arguments.length,r=new Array(n),t=0; t<n; t++)r[t]=arguments[t];return e=C.call.apply(C,[this].concat(r)),e.state={notices:[]},e.hookRefs=new Map,e.add=function(a, u){var p,c=(p=a.key)!==null&&p!==void 0?p:w(),l=N(N({},a),{},{key:c}),s=e.props.maxCount;e.setState(function(i){var o=i.notices,m=o.map(function(h){return h.notice.key}).indexOf(c),v=o.concat();return m!==-1?v.splice(m,1,{notice:l,holderCallback:u}):(s&&o.length>=s&&(l.key=v[0].notice.key,l.updateMark=w(),l.userPassKey=c,v.shift()),v.push({notice:l,holderCallback:u})),{notices:v}})},e.remove=function(a){e.setState(function(u){var p=u.notices;return{notices:p.filter(function(c){var l=c.notice,s=l.key,i=l.userPassKey,o=i!=null?i:s;return o!==a})}})},e.noticePropsMap={},e}return j(f,[{key:"getTransitionName",value:function(){var n=this.props,r=n.prefixCls,t=n.animation,a=this.props.transitionName;return!a&&t&&(a="".concat(r,"-").concat(t)),a}},{key:"render",value:function(){var n=this,r=this.state.notices,t=this.props,a=t.prefixCls,u=t.className,p=t.closeIcon,c=t.style,l=[];return r.forEach(function(s, i){var o=s.notice,m=s.holderCallback,v=i===r.length-1?o.updateMark:void 0,h=o.key,d=o.userPassKey,x=N(N(N({prefixCls:a,closeIcon:p},o),o.props),{},{key:h,noticeKey:d||h,updateMark:v,onClose:function(b){var P;n.remove(b),(P=o.onClose)===null||P===void 0||P.call(o)},onClick:o.onClick,children:o.content});l.push(h),n.noticePropsMap[h]={props:x,holderCallback:m}}),y("div",{className:T(a,u),style:c,children:y(F,{keys:l,motionName:this.getTransitionName(),onVisibleChanged:function(i, o){var m=o.key;i||delete n.noticePropsMap[m]},children:function(s){var i=s.key,o=s.className,m=s.style,v=s.visible,h=n.noticePropsMap[i],d=h.props,x=h.holderCallback;return x?y("div",{className:T(o,"".concat(a,"-hook-holder")),style:N({},m),ref:function(b){typeof i>"u"||(b?(n.hookRefs.set(i,b),x(b,d)):n.hookRefs.delete(i))}},i):y(_,{...d,className:T(o,d==null?void 0:d.className),style:N(N({},m),d==null?void 0:d.style),visible:v})}})})}}]),f}(M.exports.Component);g.newInstance=void 0;g.defaultProps={prefixCls:"rc-notification",animation:"fade",style:{top:65,left:"50%"}};g.newInstance=function(C, f){var e=C||{},n=e.getContainer,r=O(e,E),t=document.createElement("div");if(n){var a=n();a.appendChild(t)}else document.body.appendChild(t);var u=!1;function p(c){u||(u=!0,f({notice:function(s){c.add(s)},removeNotice:function(s){c.remove(s)},component:c,destroy:function(){W(t),t.parentNode&&t.parentNode.removeChild(t)},useNotification:function(){return B(c)}}))}L(y(g,{...r,ref:p}),t)};export{g as N,B as u};
